
{% extends ':Layout:layout2.html.twig' %}

{% block descripcion_y_acciones %}

{% endblock %}
{% block js_extend %}
    <link rel="stylesheet" href="{{ asset('Resources/lobibox-master/dist/css/lobibox.min.css')}}">

    <script src = "{{ asset('Resources/js/tipoempresa/tipoempresa.js') }}"  type = "text/javascript" ></script>

    <script src = "{{ asset('Resources/js/empresa/function.js') }}"  type = "text/javascript" ></script>    
    <script src = "{{ asset('Resources/Empresa/globalfunction.js') }}"  type = "text/javascript" ></script> 
    <script src = "{{ asset('Resources/vContra/strength.js') }}"  type = "text/javascript" ></script>
    <script src = "{{ asset('Resources/vContra/js.js') }}"  type = "text/javascript" ></script> 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="{{asset('Resources/AdminLTE-2.3.0/dist/css/AdminLTE.min.css')}}">
    <link rel="stylesheet" href="{{asset('Resources/AdminLTE-2.3.0/plugins/iCheck/square/blue.css')}}">
    <link href="{{asset('Resources/src/css/menu_movil.css')}}" rel="stylesheet">
    {# <link rel="stylesheet" media="screen" type="text/css" href="{{ asset('Resources/colorpicker/css/colorpicker.css') }}" />
    <script type="text/javascript" src="{{ asset('Resources/colorpicker/js/colorpicker.js') }}"></script>#}

    {#<link href="{{asset('Resources/jquery-validation-1.15.0/demo/css/screen.css')}}" rel="stylesheet">#}
    <script src="{{ asset('Resources/jquery-validation-1.15.0/dist/jquery.validate.js')}}"></script>
    <script type = "text/javascript" >
        $(document).on('ready', function () {
            $("#frmEmpresaUsuarioPersona").validate({
            });
        });
    </script>  
    <style>
        .error{
            color:#F00;
            font-style: italic;
        }
    </style>
{% endblock %} 
{% block navegacion_Y_body %}
{% block navegacion %}{% endblock %}
{% block cuerpo %}
    <div id="page-content">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h2 style="color: black;" class="text-center">Registro de abogados</h2>
                </div>
                <form id="frmEmpresaUsuarioPersona" >
                    <div class="clearfix"></div>
                    <div class="col-md-12" style="margin-top: -35px;">
                        <!-- general form elements -->
                        <div class="login-box">
                            <div class="login-box-body" style="box-shadow: 3px 3px 2px #888888;">
                                <p class="login-box-msg text-success" style="font-size: 1.17em;">Ingreso de datos generales</p>
                                <div class="form-group has-feedback">
                                    <label for="nombreEmpleado">Nombres</label>
                                    <input type="text" required class="form-control" id="txtnombre" name="txtnombre" placeholder="Nombres" data-rule-required="true" >
                                    <span class="glyphicon glyphicon-user form-control-feedback"></span>
                                </div>
                                <div class="form-group has-feedback">
                                    <label for="ejemplo_password_1">Apellidos</label>
                                    <input type="text" required class="form-control"  id="txtapellido" name="txtapellido" placeholder="Apellidos" data-rule-required="true" >
                                    <span class="glyphicon glyphicon-user form-control-feedback"></span>
                                </div>
                                <div class="form-group has-feedback">
                                    <label for="correoEmpresa">Correo electronico :</label>
                                    <input type="email" class="form-control correo" id="correoEmpresa" name="correoEmpresa" data-rule-email="true"  required placeholder="ejemplo@ejemplo.com" >
                                    <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
                                </div>
                                <div class="form-group has-feedback">
                                    <label for="correoEmpresa">Contraseña:</label>
                                    <input type="password" required class="form-control" id="contrasenha" name="contrasenha" placeholder="Contraseña" data-rule-required="true" >
                                    <span class="glyphicon glyphicon-lock form-control-feedback"></span>
                                </div>
                                <div class="form-group">
                                    <button  type="submit" class="btn btn-primary btn-flat" onClick="enviar()" id="bntenviar" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Enviando">Registrarme</button>
                                    <a href="{{ path('abogado_login') }}" class="button">
                                        <button class="btn btn-social btn-facebook btn-flat" style="background-color: #3a5795; color: #FFFFFF"><i class="fa fa-facebook"></i> Conectar con Facebook</button>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>  
            </div> 
        </div> 
    </div> 
    <script src="{{asset('Resources/AdminLTE-2.3.0/plugins/jQuery/jQuery-2.1.4.min.js')}}"></script>
    <script src="{{ asset('Resources/lobibox-master/dist/js/lobibox.min.js') }}"></script>
    <script src="{{asset('Resources/src/js/menu_movil.js')}}"></script>
    <script  src="{{asset('Resources/AdminLTE-2.3.0/bootstrap/js/bootstrap.min.js')}}"></script>

    <script type="text/javascript">

                                        function enviar()
                                        {

                                            if ($('#txtnombre').val() !== null && $("#txtapellido").val() !== "" && $("#correoEmpresa").val() !== "" && ($("#contrasenha").val() !== ""))
                                            {
                                                $("#frmEmpresaUsuarioPersona").submit(
                                                        function (event) {
                                                            $("#bntenviar").button('loading');
                                                            $("#bntenviar").prop("disabled", true);
                                                            $.ajax({
                                                                data: {dato: $("#frmEmpresaUsuarioPersona").serialize()},
                                                                url: Routing.generate('validar_correo'),
                                                                type: 'POST',
                                                                dataType: 'json',
                                                                success: function (data) {

                                                                    console.log(data.data);
                                                                    if (data.data == true) {
                                                                        //Ajax de insersion de datos               
                                                                        $.ajax({
                                                                            data: {dato: $("#frmEmpresaUsuarioPersona").serialize()},
                                                                            url: Routing.generate('ingresar_usuarioEmpresa'),
                                                                            type: 'POST',
                                                                            dataType: 'json',
                                                                            success: function (data)
                                                                            {
                                                                                console.log(data.estado);

                                                                                if (data.estado == true) {

                                                                                    var url = Routing.generate('confirma_cuenta');
                                                                                    ///        var url = Routing.generate('perfil');
                                                                                    //var url = Routing.generate('abogado_login');
                                                                                    window.open(url, "_self");
                                                                                    Lobibox.notify("success", {
                                                                                        size: 'mini',
                                                                                        msg: 'Registro exitoso, espere un momento'
                                                                                    });
                                                                                } else {

                                                                                    Lobibox.notify("error", {
                                                                                        size: 'mini',
                                                                                        msg: 'Error al ingresar los datos'
                                                                                    });
                                                                                }

                                                                                $("#bntenviar").prop("disabled", false);
                                                                                $("#bntenviar").button('reset');

                                                                                return false;
                                                                            }
                                                                        });
                                                                    } else {
                                                                        Lobibox.notify("error", {
                                                                            size: 'mini',
                                                                            msg: 'Correo ya existente, intente con otro.'
                                                                        });
                                                                        $("#bntenviar").prop("disabled", false);
                                                                        $("#bntenviar").button('reset');
                                                                    }
                                                                }
                                                            });
                                                            event.preventDefault();
                                                        });

                                            }

                                        }
    </script>
{% endblock %}
{% endblock %}
