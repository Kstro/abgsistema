
{% block js_extend %}
    <!-- Calendar -->
    <style type="text/css">
        .image-upload >input {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="{{ asset('Resources/select2/dist/css/select2.min.css') }}">
    <!--link rel="stylesheet" href="{#{ asset('Resources/zebra/css/bootstrap.css') }}">
    <script type="text/javascript" src="{{ asset('Resources/zebra/js/zebra_datepicker.js')}}" ></script>
    <link rel="stylesheet" href="{{ asset('Resources/lobibox-master/dist/css/lobibox.min.css')}}">

    <!--  Select  2-->
    <link rel="stylesheet" href="{{ asset('Resources/select2/dist/css/select2.min.css') }#}"-->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{{ asset('Resources/lobibox-master/dist/css/lobibox.min.css')}}">
    <script src="{{ asset('Resources/lobibox-master/dist/js/lobibox.min.js') }}"></script>
    <link rel="stylesheet" href="{{ asset('Resources/lobibox-master/dist/css/lobibox.min.css')}}">
    <link rel="stylesheet" media="screen" type="text/css" href="{{ asset('Resources/colorpicker/css/colorpicker.css') }}" />

    <!-- Los script que he importado -->


    <script type="text/javascript" src='http://maps.google.com/maps/api/js?sensor=false&libraries=places'></script>

    <script src = "{{ asset('Resources/cropit-master/dist/jquery.cropit.js') }}"  type = "text/javascript" ></script> 

    <link href="{{asset('Resources/src/css/style-contenedores.css')}}" rel="stylesheet">
    <script src="{{ asset('Resources/select2/dist/js/select2.min.js') }}"></script>

    <link rel="stylesheet" href="{{ asset('Resources/AdminLTE-2.3.0/dist/css/AdminLTE.min.css') }}">
    <style>
        .image-editor{
            top: -150px!important;;
        }
        .cropit-preview {
            background-color: #f8f8f8;
            background-size: cover;
            border: 1px solid #ccc;
            border-radius: 3px;
            margin-top: 7px;
            width: 200px;
            height: 200px;

        }

        .cropit-preview-image-container {
            cursor: move;
            position: absolute;


        }

        .image-size-label {
            margin-top: 10px;
        }

        {#  input {
            display: block;
          }#}

        button[type="submit"] {
            margin-top: 0px;
        }

        #result {
            margin-top: 10px;
            width: 900px;
        }

        #result-data {
            display: block;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            word-wrap: break-word;
        }
    </style>

    <script type="text/javascript">



        $(document).ready(function () {

            $("#gif").hide();
            $(document).on("click", "#botonModalP", function () {
                $("#idModalFotoP").modal();

            });
        });
        $(function editarFoto() {

            $('.image-editor').cropit();
            $('form').submit(function () {


                // Move cropped image data to hidden input
                var imageData = $('.image-editor').cropit('export');
                $('.hidden-image-data').val(imageData);
                //alert(imageData);
                var usuario = $("#usuario").val();
                var hPersona = $("#hPersonaModal").val();
                $("#gif").show();
                //Aqui tiene que ir el ajax
                $.ajax({
                    type: 'POST',
                    async: false,
                    dataType: 'json',
                    data: {imageDatas: imageData, usuario: usuario, personaId: hPersona},
                    url: Routing.generate('ingresar_foto_persona'),
                    success: function (data)
                    {
                        if (data.estado == true) {

                            Lobibox.notify("success", {
                                size: 'mini',
                                msg: 'Datos modificados con exito'
                            });
                            $("#prevP").attr('src', "/abgsistema/web/" + data.direccion);
                            $("#perfilAdminP2").attr('src', "/abgsistema/web/" + data.direccion);
                            $("#gif").hide();
                            $('#idModalFotoP').modal('toggle');
                        }

                    },
                    error: function (xhr, status)
                    {
                        Lobibox.notify("danger", {
                            size: 'mini',
                            msg: 'Lo sentimos, ocurrio un error'
                        });
                        $("#gif").hide();
                        $(".close").click();
                        $('#idModalFotoP').modal('toggle');
                    }
                });
                // Print HTTP request params
                var formValue = $(this).serialize();
                $('#result-data').text(formValue);
                // Prevent the form from actually submitting
                return false;
            });
        });
    </script>
{% endblock %} 

{% block navegacion_Y_body %}

    {% block navegacion %}

    {% endblock %}
    {% block cuerpo %}

        <!-- PRIMERA BLOQUE CON FOTO DE PERFIL -->
        <div id="verPerfil"> </div>
        <div id="editarPerfil"> 
            <div class="row" style=" margin-left:15px; margin-right:15px; ">
                <div class="box box-widget">

                    <div class="box-body">
                        <div class="col-sm-3" >
                            <div class="row" >
                                <input type="hidden" id="hPersona"  value="{{datos.id}}">
                                <form id="frmPersonaConFoto" role="form" enctype="multipart/form-data" method="POST">
                                    {% if abgFoto %}   
                                        <div class="col-sm-3 col-xs-3" >
                                            <img src="{{ asset('Resources/icons/photo.png') }}" style="width: 25px; height: 25px; margin-left: 10px; margin-top:10px; position: absolute; " id="botonModalP" title="Cambiar foto de perfil" >
                                            <div style="margin-top:5px;margin-left: -5px;" >
                                                <center>
                                                    <img id="prevP" src="{{ asset('') }}{{abgFoto[0].src}}"  style="max-height:200px; max-width:200px; " class="img-responsive" alt="Imagen responsive"/>
                                                </center>              
                                            </div>     
                                        </div>
                                    {%endif%}                
                                </form> 
                                {# Termina la parte agregada#}
                            </div>        
                        </div>
                        <div class="col-sm-6" >
                            <div class="row" >
                                <div class="col-xs-10" style="padding-right: 0;">
                                    <p style="margin-top: 10px; font-size: 23px; margin-left: 10px; margin-bottom: 0px;" class="sans">
                                        <strong>  
                                            <a href="#" id="txtNombres" data-type="addnombres" data-pk="1" data-title="Nombre" data-placement="right" class="editable editable-click" > {{datos.nombre~' '~datos.apellido}}
                                            </a>
                                        </strong>
                                        {%if(datos.verificado==1)%}
                                            <img src="{{asset('Resources/src/img/verified.png')}}" style="width: 25px; margin-bottom: 0px;" data-toggle="tooltip" data-placement="right" title="Abogado Verificado"></p>
                                        {%endif%}
                                </div></div>
                            <div class="row" >
                                <div class="col-xs-10" style="padding-right: 0;">
                                    <p style="color: #777777; margin-left: 11px; margin-top: -3px; margin-bottom: 0px;" class="sansli">


                                        <a href="#" id="txtTituloProfesional" data-type="text" data-pk="1" data-title="Nombre" data-placement="right" class="editable editable-click" title="Título Profesional">
                                            {%if datos.tprofesional|default is not empty %} {{datos.tprofesional}}
                                            {%else%}
                                                Título Profesional
                                            {%endif%}
                                        </a>


                                    </p>
                                </div>
                            </div>
                            <div class="row" >
                                <div class="col-xs-10" style="padding-right: 0;">

                                    {%if ciuda|default is not empty %}

                                        <div  style="display:block;" id="divMunicipiox">
                                            <p style="color: 5555555; margin-left: 11px; font-size: 12px; margin-bottom: 5px;" class="sansli">
                                                <a href="#" id="txtMunicipio" data-type="address" data-pk="1" data-title="Departamento | municipio" data-placement="right" class="editable editable-click" >
                                                    {% for datos in ciuda %}
                                                        <b> {{datos.estado}} </b> | {{datos.nombre}} 
                                                    {%endfor%}
                                                </a>
                                            </p>
                                        </div>
                                    {%else%}
                                        <div id="divMunicipiox">
                                            <p style="color: 5555555; margin-left: 11px; font-size: 12px; margin-bottom: 5px;" class="sansli">
                                                <a href="#" id="txtMunicipio" data-type="address" data-pk="1" data-title="Departamento | municipio" data-placement="right" class="editable editable-click" >
                                                    <b>Departament</b> | Municipiio
                                                </a>
                                            </p>
                                        </div>
                                    {%endif%}

                                </div>
                            </div>
                            <!-- ESPECIALIDAD(ES) -->
                            <div class="row" >
                                <div class="col-xs-3" style="padding-right: 0;">
                                    <span style="color: #4444444; font-size: 11px; margin-left: 10px;">Especialidades</span>
                                </div>
                                <div class="col-xs-9" style="padding-left: 0;" >
                                    <span style="font-size:13px;">
                                        <a href="#Especialidades"  >
                                            {%if RegistroEspecialida|default is not empty %}
                                                {%set esp=""%}
                                                {% for datos in RegistroEspecialida %}
                                                    {%set esp=datos.nombre~", "~esp%}
                                                {%endfor%}
                                                {{esp|slice(0,-2)}}
                                            {%else%}
                                                Añadir especialidades
                                            {%endif%}
                                        </a>
                                    </span>
                                </div>
                            </div>
                            <!-- TRABAJO(S) ACTUAL -->
                            <div class="row" >
                                <div class="col-xs-3" style="padding-right: 0;">
                                    <span style="color: #4444444; font-size: 11px; margin-left: 10px;">Actual</span>
                                </div>
                                <div class="col-xs-9" style="padding-left: 0;">
                                    <span style="font-size:13px;">
                                        {%if RegistradaExperiencia|default is not empty %}
                                            {% for datos in RegistradaExperiencia %}
                                                {%if (datos.dias is null)%}
                                                    <a href="#Experiencia"  >{{datos.empresa}}</a>
                                                {%else%}

                                                {%endif%}   
                                            {%endfor%}
                                        {%else%}
                                            <a href="#Experiencia"  >Añadir experiencia</a> 
                                        {%endif%}

                                    </span>
                                </div>
                            </div>
                            <!-- EDUCACION MAS RECIENTE -->
                            <div class="row">
                                <div class="col-xs-3" style="padding-right: 0;">
                                    <span style="color: #4444444; font-size: 11px; margin-left: 10px;">Educación</span>
                                </div>
                                <div class="col-xs-9" style="padding-left: 0;">
                                    <span style="font-size:13px;">
                                        <a href="#divEducacion">
                                            {%if Edu|default is not empty %}
                                                {% for datos in Edu %}
                                                    {%if(datos.anio=='')%} {{datos.institucion}}

                                                    {%endif%}
                                                {%endfor%}
                                            {%else%}
                                                Añadir educación
                                            {%endif%}

                                        </a>
                                    </span>
                                </div>
                            </div>
                            <!-- EDUCACION MAS RECIENTE -->
                            <div class="row">
                                <div class="col-xs-3" style="padding-right: 0;">
                                    <span style="color: #4444444; font-size: 11px; margin-left: 10px;">Sitio Web</span>
                                </div>
                                <div class="col-xs-9" style="padding-left: 0;">
                                    <span style="font-size:13px;">
                                        <a href="#" id="sitioweb" data-type="text" data-placement="right" data-pk="1"  data-title="Sitio web">
                                            {%if sitio|default is not empty %}
                                                {% for datos in sitio %}
                                                    {{datos.nombre}} 
                                                {%endfor%}
                                            {%else%}
                                                Sitio web
                                            {%endif%}
                                        </a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>  
                   <div class="box box-widget">
                        <div class="box-header with-border">
                            <h3 class="box-title">DATOS DE CONTACTO</h3>

                            <div class="box-tools pull-right">

                                <button type="button" class="btn btn-box-tool"  id="btnDatosContacto">
                                    <i class="fa fa-cog pull-right"></i></button>

                            </div>
                        </div>
                        <div class="box-body">


                            <div class="row " id="datosContacto" style="padding-left: 10px; padding-right: 15px;">
                                <div class="col-sm-3 col-xs-12">
                                    <p style="color: #4444444; font-size: 11px; margin-bottom: 0px;"><strong>Telefono(s)</strong></p>
                                    <p style="font-size: 11px; margin-bottom: 0px;">
                                        +503  
                                        <a href="#" id="txtMovil" data-type="text" data-placement="right" data-title="Telefono movil"> {%if datos.movil|default is not empty %}{{datos.movil}}
                                            {%else%}
                                                Movil
                                                {%endif%}</a>
                                                </br>+503 <a href="#" id="txtOficina" data-type="text" data-placement="right" data-title="Telefono de Oficina">
                                                    {%if datos.Tfijo|default is not empty %}
                                                        {{datos.Tfijo}}
                                                    {%else%}
                                                        Oficina
                                                    {%endif %}
                                                </a></p>
                                        </div>
                                        <div class="col-sm-3 col-xs-12">
                                            <p style="color: #4444444; font-size: 11px; margin-bottom: 0px;"><strong>Email(s)</strong></p>
                                            <p style="font-size: 11px; margin-bottom: 0px;">
                                                <a href="#" id="txtCorreo" data-type="text" data-placement="right" data-pk="1"  data-title="Sitio web">
                                                    {%if datos.correo|default is not empty %}
                                                        {{datos.correo}}
                                                    {%endif %}
                                                </a></p>
                                        </div>
                                        <div class="col-sm-3 col-xs-12">
                                            <p style="color: #4444444; font-size: 11px; margin-bottom: 0px;"><strong>Dirección</strong></p>
                                            <p style="font-size: 11px; margin-bottom: 0px;">
                                                <a href="#" id="txtDireccion" data-type="text" data-placement="right" data-title="Dirección">
                                                    {%if datos.direccion|default is not empty %}
                                                        {{datos.direccion}}
                                                    {%else%}
                                                        Dirección
                                                    {%endif%}</a>
                                            </p>
                                        </div>
                                        <div class="col-sm-3 col-xs-12">
                                            <p style="color: #4444444; font-size: 11px; margin-bottom: 0px;"><strong>Sitio web</strong></p>
                                            <p style="font-size: 11px; margin-bottom: 0px;">
                                                <a href="#" id="sitioweb2" data-type="text" data-placement="left" data-title="Sitio">
                                                    {%if sitio|default is not empty %}
                                                        {% for datos in sitio %}
                                                            {{datos.nombre}} 
                                                        {%endfor%}
                                                    {%else%}
                                                        Sitio web
                                                    {%endif%}
                                                </a>
                                        </div>

                                    </div>
                                    <!-- Fin -->
                                </div>
                            </div>
            </div>
        </div>
        <script type="text/javascript">
            $(function () {
                $('[data-toggle="tooltip"]').tooltip()
            })


        </script>

    {% endblock %}
{% endblock %}



<div class="modal fade modal" id="idModalFotoP" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header " Style="height:45px;">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
                <span class="robo" style="font-size: 20px; ">Editar foto de perfil</span>
            </div>
            <div class="modal-body" id="mbodyExperiencia" >

                <form action="#" id="frmEmpresaConFoto" role="form" enctype="multipart/form-data" method="POST">
                    {% if abgFoto %}


                        <div class="image-editor" >
                            <center>
                                <div class="cropit-preview" style="z-index: 3; background-image:url({{ asset('') }}{{ abgFoto[0].src}}) ; border-color:white; " ></div>
                            </center>
                            <div class="image-upload" >
                                <label for="input" >
                                    <img src="{{ asset('Resources/icons/photo.png') }}" style="width: 25px; height: 25px; margin-left: 40px; margin-top:-200px;; position: relative; z-index: 3; " title="Click para seleccionar una imagen" >
                                </label>

                                <input type="file" class="cropit-image-input" id="input">      

                            </div>
                            <center>    
                                <div class="image-size-label" id="labelid">
                                    Dimension de imagen
                                </div>
                                <input type="range" class="cropit-image-zoom-input" style="width: 140px;" id="idrange">
                                <input type="hidden" name="image-data" class="hidden-image-data" />
                                <input type="hidden" name="user" value="{{ usuario }}" id="usuario">
                                <input type="hidden" id="hPersonaModal"  value="{{datos.id}}" name="personaId">
                            </center>

                        </div>


                    {% endif %}

            </div>
            <div class="modal-footer" id="botomExperiencia" >
                <img src='{{ asset('Resources/icons/transfer.gif') }}' style="width: 25px; height: 25px; margin-right:70px; " id="gif">

                <button type="submit" id="cmd" class="btn btn-success">Cortar y Guardar</button>
            </div>

        </div>
    </div>
</form>  
</div>

